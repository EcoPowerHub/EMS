{
  "debug": true,
  "context": {
    "objects": {
      "pv1": {
        "type": "pv",
        "description": "Ouai les gars c'est le pv, Ã§a photovoltaÃ¯que un max ou quoi ? ðŸ¤™"
      },
      "poc": {
        "type": "metric",
        "description": "Ouai les gars c'est le poc, Ã§a mesure un max ou quoi ? ðŸ¤™",
        "init_value": {
          "value": 1000
        }
      },
      "limit": {
        "type": "metric",
        "description": "Ouai les gars c'est le limit, Ã§a limite un max ou quoi ? ðŸ¤™",
        "init_value": {
          "value": 100
        }
      },
      "setpoint": {
        "type": "setpoint",
        "description": "Ouai les gars c'est le setpoint, Ã§a setpoint un max ou quoi ? ðŸ¤™",
        "init_value": {
          "p_kw": 0
        }
      },
      "load":{
        "type": "metric",
        "description": "Ouai les gars c'est le load, Ã§a consomme un max ou quoi ? ðŸ¤™"
      },
      "ess":{
        "type": "battery",
        "description": "Ouai les gars c'est l'ess, Ã§a stocke un max ou quoi ? ðŸ¤™"
      },
      "battery_status":{
        "type": "status",
        "description": "Ouai les gars c'est le status, Ã§a status un max ou quoi ? ðŸ¤™",
        "init_value": {
          "value": 1
        }
      }
    }
  },
  "equipments": [
    {
      "id": "generic/pv",
      "description": "equipmentPv",
      "host": "localhost:5502",
      "name": "pv",
      "inputs": {},
      "outputs": {
        "pv": {
          "pv": {
            "ref": "pv1"
          }
        }
      }
    }
  ],

  "modes": {
    "modes":[
      {
        "name":"peakshaving",
        "description":"Ouai les gars c'est le peakshaving, Ã§a shave un max ou quoi ? ðŸ¤™",
        "enabledServices":["peakshaving","eval"],
        "condition":"battery_status"
      }
    ]
  },

  "services": {
    "peakshaving": {
      "id": "peakshaving",
      "priority": 1,
      "conf": {
        "conf": {
          "pid_controller": {
            "kp": 0.1,
            "ki": 0.1,
            "kd": 0.1,
            "period": "1s"
          }
        },
        "inputs": {
          "poc_kW": {
            "ref": "poc",
            "attr": "value"
          },
          "limit_kW": {
            "ref": "limit",
            "attr": "value"
          }
        },
        "outputs": {
          "setpoint": {
            "ref": "setpoint"
          }
        }
      }
    },
    "eval":{
      "id": "gval",
      "priority": 2,
      "conf": {
        "conf": {
          "expression": "poc_kW > 30 ? 1 : 0"
        },
        "inputs": {
          "poc_kW": {
            "ref": "poc",
            "attr": "value"
          },
          "ess": {
            "ref": "pv1",
            "attr": "p_kw"
          }
        },
        "outputs": {
          "status": {
            "ref": "battery_status",
            "attr": "value"
          }
        }
      }
    },
    "peakshaving_2": {
      "id": "peakshaving",
      "priority": 1,
      "conf": {
        "conf": {
          "pid_controller": {
            "kp": 0.1,
            "ki": 0.1,
            "kd": 0.1,
            "period": "1s"
          }
        },
        "inputs": {
          "poc_kW": {
            "ref": "poc",
            "attr": "value"
          },
          "limit_kW": {
            "ref": "limit",
            "attr": "value"
          }
        },
        "outputs": {
          "setpoint": {
            "ref": "setpoint"
          }
        }
      }
    }
  }
}
